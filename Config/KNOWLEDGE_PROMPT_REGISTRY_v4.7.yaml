# KNOWLEDGE PROMPT REGISTRY v4.7
# 版本: 4.7 PRODUCTION (Updated 2026-02-20)
# 最後更新: 2026-02-20
# 用途: 集中管理所有知識提示檔案的路徑、版本和狀態，實現統一的三層架構
# 重要更新: 
# 1. 整合 ESTIMAIT_California_Real_Price_List_v1.0 (解決無 RSMeans 數據問題)
# 2. 優化 LAYER 3.1 & 3.3 核心邏輯 (整合 Advantech 與 Colton II 案例特徵)

---

# ============================================================================
# LAYER 0: 協作工作流程 (Collaborative Workflow)
# ============================================================================

LAYER0:
  - name: "dotbrand ESTIMAIT 2 - SYSTEM INSTRUCTION PROMPT v2.2 (PRODUCTION)"
    file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/dotbrand ESTIMAIT 2 - SYSTEM INSTRUCTION PROMPT v2.2 (PRODUCTION).md"
    status: "PRODUCTION"
    version: "2.2"
    description: "Updated with Public/Private detection and Multi-site Mobilization logic."

---

# ============================================================================
# LAYER 1: 估算方法論 (Estimation Methodology)
# ============================================================================

LAYER1:
  CORE_ENGINE:
    - name: "LAYER1_CORE_ESTIMATION_ENGINE_v2.5_PRODUCTION"
      file_path: "/home/ubuntu/projects/dotbrand-estimait-4/LAYER1_CORE_ESTIMATION_ENGINE_v2.5.md"
      status: "PRODUCTION"
      version: "2.5"
      updated: "2026-02-20"
      description: "Includes Volume-Risk Matrix for concrete and Inverse Scale Profit logic."
      
      improvements_from_v2_2:
        - "Integrated Renovation Cost Factor Matrix"
        - "Added Renovation Scope Assessment Logic"
        - "Enhanced Renovation Factor Application"
        - "Separated NEW CONSTRUCTION vs. RENOVATION cost models"
      includes:
        - "Parametric Hard Cost Model (v2.3 - with renovation factors)"
        - "Project Complexity Scoring (Section 3.2)"
        - "Geotechnical Cost Integration (Section 3.3)"
        - "Specialized Systems Premium (Section 3.4)"
        - "Indirect Cost Calculation (Section 3.5)"
        - "Sanity Check Protocol (8-step)"
        - "Case-Based Sanity Check"
        - "Monte Carlo Simulation Framework"
        - "Renovation Intensity Definitions"
        - "Renovation vs. New Construction Decision Logic (NEW v2.3)"
        - "Renovation Factor Application (NEW v2.3)"
        - "Renovation Cost Factor Matrix Integration (NEW v2.3)"

  RENOVATION_FACTORS:
    - name: "RENOVATION_COST_FACTOR_MATRIX_v1.0_PRODUCTION"
      file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/RENOVATION_COST_FACTOR_MATRIX_v1.0.yaml"
      status: "PRODUCTION"
      version: "1.0"
      created: "2026-02-09"
      type: "Cost Factor Matrix"
      description: "翻新成本因子矩陣，系統化量化翻新成本乘數"
      building_types:
        - "Commercial Office (1.2x - 2.5x)"
        - "Warehouse (1.2x - 2.0x)"
        - "Healthcare (1.5x - 2.8x)"
      renovation_scopes:
        - "Light (Level 1)"
        - "Moderate (Level 2)"
        - "Heavy (Level 3)"
      regions: 7
      validated_projects:
        - "YTEC Scott Boulevard (Commercial Office, Moderate, CA Bay Area)"
      usage:
        - "Query by building_type, renovation_scope, region"
        - "Returns: base_factor, regional_adjustment, final_factor, confidence"

  GEOTECHNICAL_FACTORS:
    - name: "GEOTECHNICAL_COST_DRIVER_MATRIX_v1.0_PRODUCTION"
      file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/GEOTECHNICAL_COST_DRIVER_MATRIX_v1.0.yaml"
      status: "PRODUCTION"
      version: "1.0"
      created: "2026-02-09"
      type: "Cost Driver Matrix"
      description: "地質成本驅動因子矩陣，量化地質條件對成本的影響"
      regions: 7
      cost_drivers: 10
      validated_projects:
        - "Advantech North America Campus (Tustin, CA)"
      usage:
        - "Query by region, building_type, stage (BIDDING/POST_AWARD/FINAL)"
        - "Returns: geotechnical_adjustment %, confidence, historical_data"
---

# ============================================================================
# NEW REFERENCE: 外部參考數據 (單價缺口補償方案)
# ============================================================================

REFERENCE:
  CALIFORNIA_REAL_PRICE:
    - name: "ESTIMAIT_California_Real_Price_List_v1.0"
      file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/reference/ESTIMAIT_California_Real_Price_List_v1.0.md"
      status: "PRODUCTION"
      version: "1.0"
      description: "2025 加州實體標單單價庫 (土方、瀝青、混凝土、鋼筋)，用於取代 RSMeans"

---

# ============================================================================
# LAYER 2: 領域特定知識 (Domain-Specific Knowledge)
# ============================================================================

LAYER2:
  WAREHOUSE:
    KNOWLEDGE:
      - name: "LAYER2_WAREHOUSE_KNOWLEDGE_v1.2_PRODUCTION"
        file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/LAYER2_WAREHOUSE_KNOWLEDGE_v1.2_PRODUCTION.md"
        status: "PRODUCTION"
        version: "1.2"
        type: "Knowledge Base"
        description: "倉庫建築類別的數據與參數知識庫（純數據，無方法論）"

    CASE_DATABASE:
      - name: "LAYER2_WAREHOUSE_CASE_DATABASE_v1.0_PRODUCTION"
        file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/LAYER2_WAREHOUSE_COST_DATABASE_v1.0_PRODUCTION.md"
        status: "PRODUCTION"
        version: "1.0"
        type: "Case Database"
        description: "倉庫建築類別的案例數據庫（真實項目案例）"

    DECISION_MATRIX:
      - name: "LAYER2_WAREHOUSE_DECISION_MATRIX_v1.1_PRODUCTION"
        file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/LAYER 2_ WAREHOUSE DECISION MATRIX v1.0.md"
        status: "PRODUCTION"
        version: "1.1"
        updated: "2026-02-09"
        type: "Decision Matrix"
        description: "倉庫建築類別的決策矩陣（快速決策工具）"
        improvements_from_v1_0:
          - "Added Renovation Cost Factor Application section"
          - "Integrated RENOVATION_COST_FACTOR_MATRIX_v1.0"
          - "Added renovation scope definitions (Light/Moderate/Heavy)"
          - "Added regional adjustments for renovations"

  HEALTHCARE:
    KNOWLEDGE:
      - name: "LAYER2_HEALTHCARE_KNOWLEDGE_v1.1_PRODUCTION"
        file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/LAYER 2_ HEALTHCARE KNOWLEDGE PROMPT v1.1.md"
        status: "PRODUCTION"
        version: "1.1"
        type: "Knowledge Base"
        description: "Updated CSI allocations based on Colton II actuals (High Div 08/05)"

    CASE_DATABASE:
      - name: "LAYER2_HEALTHCARE_CASE_DATABASE_v1.1_PRODUCTION" # Updated name
        file_path: "/home/ubuntu/projects/dotbrand-estimait-4/LAYER3_CASE_DATABASE_v1.1_PRODUCTION.yaml"
        status: "PRODUCTION"
        version: "1.1" # Updated version
        type: "Case Database"
        description: "醫療保健案例數據庫，數據結構已更新為 Hard/Soft。"

    DECISION_MATRIX:
      - name: "LAYER2_HEALTHCARE_RENOVATION_DECISION_MATRIX_v1.1_PRODUCTION"
        file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/LAYER 2_ HEALTHCARE RENOVATION DECISION MATRIX v1.0.md"
        status: "PRODUCTION"
        version: "1.1"
        updated: "2026-02-09"
        type: "Decision Matrix"
        description: "醫療保健建築類別的決策矩陣（快速決策工具）"
        improvements_from_v1_0:
          - "Added Renovation Cost Factor Application section"
          - "Integrated RENOVATION_COST_FACTOR_MATRIX_v1.0"
          - "Added renovation scope definitions (Light/Moderate/Heavy)"
          - "Added YTEC Scott Boulevard case validation"

  COMMERCIAL:
    KNOWLEDGE:
      - name: "LAYER2_COMMERCIAL_KNOWLEDGE_v1.0_PRODUCTION"
        file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/LAYER 2_ COMMERCIAL KNOWLEDGE PROMPT v1.0.md"
        status: "PRODUCTION"
        version: "1.0"
        type: "Knowledge Base"
        description: "商業辦公建築類別的數據與參數知識庫（純數據，無方法論）"

    CASE_DATABASE:
      - name: "LAYER2_COMMERCIAL_CASE_DATABASE_v1.0_PRODUCTION"
        file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/LAYER 2_ COMMERCIAL CASE DATABASE v1.0.md"
        status: "PRODUCTION"
        version: "1.0"
        type: "Case Database"
        description: "商業辦公建築類別的案例數據庫（真實項目案例）"

    DECISION_MATRIX:
      - name: "LAYER2_COMMERCIAL_DECISION_MATRIX_v1.1_PRODUCTION"
        file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/LAYER 2_ COMMERCIAL DECISION MATRIX v1.0.md"
        status: "PRODUCTION"
        version: "1.1"
        updated: "2026-02-09"
        type: "Decision Matrix"
        description: "商業辦公建築類別的決策矩陣（快速決策工具）"
        improvements_from_v1_0:
          - "Added Renovation Cost Factor Application section"
          - "Integrated RENOVATION_COST_FACTOR_MATRIX_v1.0"
          - "Added renovation scope definitions (Light/Moderate/Heavy)"
          - "Added YTEC Scott Boulevard case validation (HIGH confidence)"

---

# ============================================================================
# LAYER 3: 可選深入驗證工具 (Optional Deep Verification Tools)
# ============================================================================

LAYER3:
  CASE_FEATURE_EXTRACTION:
    - name: "LAYER 3.1_ CASE FEATURE EXTRACTION v1.1 (OPTIMIZED)"
      file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/LAYER 3.1_ CASE FEATURE EXTRACTION v1.0 (PRODUCTION).md"
      status: "PRODUCTION"
      version: "1.1"
      type: "Feature Extraction"
      description: "新增 [Geo_Seismic], [HCAI_Med], [Anti_Lig] 等案例特徵開關"

  CASE_SIMILARITY_MATCHING:
    - name: "LAYER 3.2_ CASE SIMILARITY MATCHING v1.0 (PRODUCTION)"
      file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/LAYER 3.2_ CASE SIMILARITY MATCHING v1.0 (PRODUCTION).md"
      status: "PRODUCTION"
      version: "1.0"
      type: "Similarity Matching"
      description: "案例相似性匹配工具，用於找到最相似的歷史項目"

  CASE_ADJUSTMENT_FACTORS:
    - name: "LAYER 3.3_ CASE ADJUSTMENT FACTORS v1.2 (PRODUCTION)"
      file_path: "/home/ubuntu/projects/dotbrand-estimait-2-bb8f0a39/LAYER 3.3_ CASE ADJUSTMENT FACTORS v1.2 (PRODUCTION).md"
      status: "PRODUCTION"
      version: "1.2"
      type: "Adjustment Factor"
      description: "Added Behavioral Health Glazing (2.5x) and Liquefaction ($15/SF) triggers"

  CASE_BASED_ESTIMATION_LOGIC:
    - name: "LAYER 3.4_ CASE-BASED ESTIMATION LOGIC v1.1 (PRODUCTION)" # Updated
      file_path: "/home/ubuntu/projects/dotbrand-estimait-4/LAYER 3.4_ CASE-BASED ESTIMATION LOGIC v1.1 (PRODUCTION).md"
      status: "PRODUCTION"
      version: "1.1"
      type: "Estimation Logic"
      description: "基於案例的估算邏輯，已更新為 Hard/Soft 架構。"

  GC_DOUBLE_CHECK_PROTOCOL:
    - name: "LAYER 3.5_ GC DOUBLE CHECK PROTOCOL v1.1 (PRODUCTION)" # Updated
      file_path: "/home/ubuntu/projects/dotbrand-estimait-4/LAYER 3.5_ GC DOUBLE CHECK PROTOCOL v1.1 (PRODUCTION).md"
      status: "PRODUCTION"
      version: "1.1"
      type: "Verification Protocol"
      description: "GC 雙重檢查協議，已更新為 Hard/Soft 架構。"

---

# ============================================================================
# GC SPECIFIC KNOWLEDGE (GC 特定知識)
# ============================================================================

GC_SPECIFIC:
  UPRITE:
    - name: "GC_SPECIFIC_UPRITE_GENERAL_v3.0" # Updated name
      file_path: "/home/ubuntu/projects/dotbrand-estimait-4/GC_SPECIFIC_UPRITE_GENERAL_v3.0.md" # Updated path
      status: "PRODUCTION"
      version: "3.0" # Updated version
      description: "Unified Hard/Soft Cost model for UPRITE. Div 01 as Hard Cost."

---

# ============================================================================
# USAGE GUIDE (使用指南)
# ============================================================================

USAGE_GUIDE:
  query_methods:
    - name: "get_knowledge_prompt(layer, building_type, stage)"
      description: "查詢知識提示的主要方法"
      examples:
        - "get_knowledge_prompt('LAYER1') → 返回 v2.3 核心估算引擎"
        - "get_knowledge_prompt('LAYER2', building_type='warehouse') → 返回倉庫知識提示"
        - "get_knowledge_prompt('RENOVATION_FACTORS', building_type='commercial_office', renovation_scope='moderate', region='CA_Bay_Area') → 返回翻新因子"
        - "get_knowledge_prompt('GEOTECHNICAL_FACTORS', region='CA_Inland', stage='BIDDING') → 返回地質調整因子"

  version_control:
    - "優先使用上述檔案版本"
    - "如果上述檔案版本不可用，自動降級到 TESTING 版本"
    - "如果使用非上述檔案版本，在估算報告中明確標記"

---

# ============================================================================
# CHANGELOG (更新日誌)
# ============================================================================

CHANGELOG:
 v4_4:
    date: "2026-02-18"
    status: "PRODUCTION"
    changes:
      - "新增參考數據區塊: 引入加州 2025 真實標單實價表"
      - "優化 LAYER 3.1: 整合 Advantech 地震地質與 Colton 醫療合規特徵開關"
      - "優化 LAYER 3.3: 加入混合用途 (Hybrid) 加權計算公式與單價缺口補償協議"
      
 v4_3:
    date: "2026-02-09"
    status: "PRODUCTION"
    changes:
      - "Added RENOVATION_COST_FACTOR_MATRIX_v1.0"
      - "Added GEOTECHNICAL_COST_DRIVER_MATRIX_v1.0"
      - "Updated LAYER1 to v2.3 (with renovation factors)"
      - "Updated LAYER2 Decision Matrices to v1.1 (with renovation cost factor application)"
      - "All files now support renovation projects with validated cost factors"

  v4_2:
    date: "2026-02-07"
    status: "PRODUCTION"
    changes:
      - "Initial registry with 3 building types (Warehouse, Healthcare, Commercial)"
      - "LAYER1 v2.2 with Complexity Scoring and Geotechnical Integration"

  v4_6:
  date: "2026-02-19"
  changes:
    - "Implemented Dynamic Data Calibration Protocol."
    - "Added real-time search triggers for Labor, Materials, and Equipment."
    - "Defined 'Expired Data' as > 3 months old."
---

# END OF KNOWLEDGE_PROMPT_REGISTRY_v4.3
